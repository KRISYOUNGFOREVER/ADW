# AI设计工作流平台 - 前端开发文档

## 1. 项目概述

基于React + TypeScript的AI设计工作流平台前端，采用MVP开发模式，专注于桌面端Web应用的核心功能。

## 2. 技术栈

- **框架**: React 18 + TypeScript
- **构建工具**: Vite
- **UI组件库**: Ant Design
- **状态管理**: React Context
- **路由**: React Router
- **实时通信**: Socket.IO Client
- **HTTP客户端**: Axios
- **样式**: CSS Modules + Ant Design

## 3. 项目结构

```
frontend/src/
├── App.tsx                 # 主应用组件
├── main.tsx               # 应用入口
├── index.css              # 全局样式
├── components/            # 通用组件
│   ├── Layout/           # 布局组件
│   └── WorkflowMonitor/  # 工作流监控组件
├── contexts/             # React Context
├── pages/                # 页面组件
│   └── Settings.tsx      # 设置页面
└── services/             # API服务层
```

## 4. MVP核心页面

### 4.1 聊天交互页面 (ChatPage)
**功能**: 类似豆包的聊天式AI交互界面
- 左侧对话列表，右侧聊天区域
- 支持文本输入、文件上传
- 实时消息展示，支持Markdown渲染
- 消息状态指示（发送中、已发送、失败）

**组件结构**:
```
ChatPage/
├── ChatSidebar.tsx       # 对话列表侧边栏
├── ChatArea.tsx          # 主聊天区域
├── MessageList.tsx       # 消息列表
├── MessageInput.tsx      # 消息输入框
└── MessageItem.tsx       # 单条消息组件
```

### 4.2 工作流监控页面 (WorkflowMonitor)
**功能**: 实时监控工作流执行状态
- 工作流列表展示
- 执行状态实时更新
- 执行日志查看
- 错误信息展示

### 4.3 系统设置页面 (Settings)
**功能**: 系统配置管理
- API配置
- 用户偏好设置
- 系统参数配置

## 5. 布局设计

### 5.1 整体布局
```
┌─────────────────────────────────────┐
│              Header                 │
├─────────────┬───────────────────────┤
│             │                       │
│   Sidebar   │    Main Content       │
│             │                       │
│             │                       │
└─────────────┴───────────────────────┘
```

### 5.2 聊天页面布局
```
┌─────────────┬───────────────────────┐
│             │      Chat Header      │
│ Conversation├───────────────────────┤
│    List     │                       │
│             │    Message List       │
│             │                       │
│             ├───────────────────────┤
│             │    Input Area         │
└─────────────┴───────────────────────┘
```

## 6. 核心组件设计

### 6.1 Layout组件
- **Header**: 导航栏，包含logo、用户信息
- **Sidebar**: 侧边栏导航
- **Content**: 主内容区域

### 6.2 聊天组件
- **ChatSidebar**: 对话历史列表
- **MessageList**: 消息展示区域
- **MessageInput**: 输入框组件，支持文件上传
- **MessageItem**: 单条消息，支持用户/AI消息样式

### 6.3 工作流组件
- **WorkflowCard**: 工作流卡片
- **StatusIndicator**: 状态指示器
- **LogViewer**: 日志查看器

## 7. 状态管理

### 7.1 Context结构
```typescript
// ChatContext - 聊天相关状态
interface ChatContextType {
  conversations: Conversation[];
  currentConversation: Conversation | null;
  messages: Message[];
  sendMessage: (content: string) => void;
}

// WorkflowContext - 工作流相关状态
interface WorkflowContextType {
  workflows: Workflow[];
  currentWorkflow: Workflow | null;
  status: WorkflowStatus;
}
```

## 8. API集成

### 8.1 服务层结构
```typescript
// services/api.ts
export const chatAPI = {
  sendMessage: (message: string) => Promise<Response>,
  getConversations: () => Promise<Conversation[]>,
  getMessages: (conversationId: string) => Promise<Message[]>
};

export const workflowAPI = {
  getWorkflows: () => Promise<Workflow[]>,
  executeWorkflow: (id: string) => Promise<ExecutionResult>,
  getWorkflowStatus: (id: string) => Promise<WorkflowStatus>
};
```

### 8.2 WebSocket集成
```typescript
// services/socket.ts
export class SocketService {
  connect(): void;
  onMessage(callback: (message: Message) => void): void;
  onWorkflowUpdate(callback: (update: WorkflowUpdate) => void): void;
  emit(event: string, data: any): void;
}
```

## 9. 样式规范

### 9.1 设计原则
- 简洁现代的界面设计
- 一致的交互体验
- 良好的可读性和可访问性

### 9.2 色彩方案
- 主色调: #1890ff (Ant Design蓝)
- 辅助色: #52c41a (成功绿), #ff4d4f (错误红)
- 中性色: #f0f0f0 (背景灰), #ffffff (纯白)

### 9.3 间距规范
- 基础间距单位: 8px
- 组件间距: 16px, 24px
- 页面边距: 24px, 32px

## 10. 开发优先级

### Phase 1 (核心功能)
1. 基础Layout组件
2. 聊天交互页面
3. WebSocket连接
4. 基础API集成

### Phase 2 (监控功能)
1. 工作流监控页面
2. 实时状态更新
3. 日志查看功能

### Phase 3 (完善功能)
1. 系统设置页面
2. 用户体验优化
3. 错误处理完善

## 11. 开发注意事项

### 11.1 代码规范
- 使用TypeScript严格模式
- 遵循React Hooks最佳实践
- 组件命名采用PascalCase
- 文件命名采用kebab-case

### 11.2 性能优化
- 使用React.memo优化组件渲染
- 合理使用useMemo和useCallback
- 图片懒加载
- 代码分割

### 11.3 错误处理
- 统一的错误边界处理
- API请求错误处理
- WebSocket连接异常处理
- 用户友好的错误提示

## 12. 部署配置

### 12.1 构建命令
```bash
npm run build    # 生产环境构建
npm run dev      # 开发环境启动
npm run preview  # 预览构建结果
```

### 12.2 环境变量
```env
VITE_API_BASE_URL=http://localhost:3001
VITE_SOCKET_URL=http://localhost:3001
```

---

**文档版本**: v1.0  
**更新日期**: 2024年1月  
**维护人员**: 开发团队